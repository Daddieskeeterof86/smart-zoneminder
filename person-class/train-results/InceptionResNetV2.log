2020-03-01 13:07:28,208 __main__     INFO     Getting dataframe with alt_label: False.
2020-03-01 13:07:28,273 __main__     INFO     Running with test enabled.
2020-03-01 13:07:28,276 __main__     INFO     Found 5 classes in data set.
2020-03-01 13:07:28,276 __main__     INFO     Creating model with cnn base: InceptionResNetV2
2020-03-01 13:07:28,276 __main__     INFO     batch size: 32, dense units 128, dropout: 0.2
2020-03-01 13:07:28,276 __main__     INFO     learning rate: 0.0001, l2 penalty: 0.0001, freeze 200
2020-03-01 13:07:41,230 __main__     INFO     Generating validation dataset.
2020-03-01 13:07:41,244 __main__     INFO     Generating train dataset.
2020-03-01 13:07:41,254 __main__     INFO     Class dict: {'Unknown': 0, 'eva_st_angel': 1, 'lindo_st_angel': 2, 'nico_st_angel': 3, 'nikki_st_angel': 4}
2020-03-01 13:07:41,254 __main__     INFO     Number of training samples: 5839
2020-03-01 13:07:41,255 __main__     INFO     Number of validation samples: 1459
2020-03-01 13:07:41,255 __main__     INFO     Class weights: {4: 1.9443207126948776, 0: 1.0186697782963827, 2: 1.0, 1: 2.954314720812183, 3: 1.9617977528089887}
2020-03-01 13:07:41,255 __main__     INFO     Steps per epoch: 182
2020-03-01 13:07:41,255 __main__     INFO     Validation steps: 45
2020-03-01 13:07:41,255 __main__     INFO     Starting pass 1.
2020-03-01 14:07:24,396 __main__     INFO     Finished pass 1.
2020-03-01 14:07:24,397 __main__     INFO     Starting pass 2 with learning rate: 1e-05
2020-03-01 14:07:37,442 __main__     INFO     Initiating pass 2 with final pass 1 model.
2020-03-01 15:55:22,941 __main__     INFO     Finished pass 2.
2020-03-01 15:57:07,952 tensorflow   WARNING  From /home/lindo/.virtualenvs/szm/lib/python3.6/site-packages/tensorflow_core/python/ops/resource_variable_ops.py:1786: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
2020-03-01 15:57:21,343 tensorflow   INFO     Assets written to: /home/lindo/develop/smart-zoneminder/person-class/train-results/InceptionResNetV2/1/assets
2020-03-01 15:57:29,400 __main__     INFO     Exported SavedModel to /home/lindo/develop/smart-zoneminder/person-class/train-results/InceptionResNetV2
2020-03-01 15:57:29,401 __main__     INFO     Evaluating model on 1825 test samples.
2020-03-01 15:58:01,852 __main__     INFO     Classification report:
                precision    recall  f1-score   support

       Unknown       0.86      0.86      0.86       534
  eva_st_angel       0.86      0.91      0.89       166
lindo_st_angel       0.93      0.95      0.94       516
 nico_st_angel       0.95      0.85      0.90       299
nikki_st_angel       0.89      0.90      0.90       310

      accuracy                           0.90      1825
     macro avg       0.90      0.90      0.90      1825
  weighted avg       0.90      0.90      0.90      1825

2020-03-01 15:58:01,854 __main__     INFO     Confusion matrix:
[[460  16  22  12  24]
 [  7 151   1   1   6]
 [ 25   0 490   0   1]
 [ 24   3  14 255   3]
 [ 22   5   2   1 280]]
2020-03-01 15:59:46,738 __main__     INFO     Quantized tflite model saved to: /home/lindo/develop/smart-zoneminder/person-class/train-results/InceptionResNetV2-person-classifier-quant.tflite
2020-03-01 15:59:50,116 __main__     INFO     Compiled model for edge tpu:
Edge TPU Compiler version 2.0.291256449

Model compiled successfully in 2996 ms.

Input model: /home/lindo/develop/smart-zoneminder/person-class/train-results/InceptionResNetV2-person-classifier-quant.tflite
Input size: 54.65MiB
Output model: /home/lindo/develop/smart-zoneminder/person-class/train-results/InceptionResNetV2-person-classifier-quant_edgetpu.tflite
Output size: 54.53MiB
On-chip memory available for caching model parameters: 5.62MiB
On-chip memory used for caching model parameters: 5.62MiB
Off-chip memory used for streaming uncached model parameters: 48.20MiB
Number of Edge TPU subgraphs: 1
Total number of operations: 396
Operation log: /home/lindo/develop/smart-zoneminder/person-class/train-results/InceptionResNetV2-person-classifier-quant_edgetpu.log

Model successfully compiled but not all operations are supported by the Edge TPU. A percentage of the model will instead run on the CPU, which is slower. If possible, consider updating your model to use only operations supported by the Edge TPU. For details, visit g.co/coral/model-reqs.
Number of operations that will run on Edge TPU: 394
Number of operations that will run on CPU: 2
See the operation log file for individual operation details.

